<html>
  <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script src="flot/jquery.flot.min.js"></script>
    <style>
      body{
        font-family: Lucida Grande, sans-serif;
      }
      form {
        position:relative;
        overflow:hidden;
      }
      form div {
        float:left;
        margin-right: 1em;
      }
      input {
        display: block;
      }
      #submit {
        position:absolute;
        bottom: 0;
      }
      #plot{
        width: 100%;
        height: 80%;
      }
      #help {
        border:1px silver solid;
        background-color:#eee;
        padding: 1em;
        margin: 1em 0;
      }
    </style>
    <script>
      // Box-Mulder from http://vorlon.case.edu/~vxl11/software/gauss.html
      function normal() {
        var u1,u2;
        u1 = u2 = 0.;
        while (u1 * u2 == 0.) {
          u1 = Math.random();
          u2 = Math.random();
        }
        return Math.sqrt(-2. * Math.log(u1)) * Math.cos(2 * Math.PI * u2);
      }
    
      function go(){
        var employees   = parseInt($('#employees').val());
        var quality     = parseFloat($('#quality').val());
        var goal        = parseFloat($('#first').val());
        var error       = parseFloat($('#error').val());
        var iterations  = parseInt($('#iterations').val());
        var data = [];
        var interviews = 0;
        for(var i = 0; i < iterations; i++) {
          var series = []
          var total = 0;
          for(var e = 0; e < employees; e++) {
            var actualValue = -10;
            var perceivedValue = -10;
            while(perceivedValue < goal) { 
              var actualValue = normal() + quality;
              var perceivedValue = actualValue + error * normal();
              interviews++;
            }
            total += actualValue;
            average = total / (e+1);
            
            series.push([e, average]);
          }
          data.push(series);
        }
        // console.log(data);
        $.plot($("#plot"), data, {xaxis: { max: employees }});
        $("#eph").text(interviews / (iterations * employees) +"");
      }
    </script>
  </head>
  <body>
    <form onsubmit="go();return false">
      <div>
        Employees to hire
        <input type="text" id="employees" value="100">
      </div>
      <div>
        Mean quality of applicant pool (z-score)
        <input type="text" id="quality" value="-1">
      </div>
      <div>
        First employee's z-score
        <input type="text" id="first" value="1">
      </div>
      <div>
        Error margin of our evaluation
        <input type="text" id="error" value="1">
      </div>
      <div>
        Iterations
        <input type="text" id="iterations" value="10">
      </div>
      <div>
        <input id="submit" type="submit" value="Graph!" />
      </div>
    </form>
    <div id="help">
      <a href="javascript:$('#help').toggle()" style="float:right">hide</a>
      <p>This is a more detailed simulation of <a href="http://googleresearch.blogspot.com/2006/03/hiring-lake-wobegon-strategy.html">Google's hiring policy.</a>  We add the following features:
      <ol>
        <li>We assume an error margin in our ability to evaluate employees.</li>
        <li>We assume an applicant pool that isn't necessarily centered on z=0.</li>
        <li>We evaluate <a href="http://en.wikipedia.org/wiki/Standard_score">z-scores</a>, not percentile.</li>
        <li>We calculate the average number of interviews for a successful hire.</li>
    </div>
    <div>
      Interviews per hire: <span id="eph">N/A</span>
    </div>
    <div id="plot">
    </div>
  </body>
</html>